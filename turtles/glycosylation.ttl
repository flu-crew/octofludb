PREFIX f: <https://github.com/arendsee/flucrew/term/>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>

## Retrieve all the sequences and metadata needed for the glycosylation study
SELECT ?id ?strain ?host ?date ?source ?glyc ?motif ?prot_id ?aa_seq ## to get the protein sequence
# SELECT ?id ?strain ?host ?date ?source ?glyc ?motif ?nt_seq
WHERE {
    # get the glycosylation project data
    ?i f:tag "glyco-project" .
    ?i foaf:name ?id .
    ?i f:p162_motif ?motif .
    ?i f:glyc_possible ?glyc .
    # get strain info
    ?strain_id f:has_segment ?i .
    ?strain_id foaf:name ?strain .
    ?strain_id f:host ?host .
    ?strain_id f:date ?date_str .
    BIND (STRDT(?date_str, xsd:dateType) as ?date) .
    # get genbank data
    ?i f:sequence ?nt_seq .
    ?i f:feature/f:translation ?aa_seq .
    ?i f:feature/f:protein_id ?prot_id .
    OPTIONAL{ ?i f:feature/f:isolation_source ?source . }
}
